# テスト実行方法

このドキュメントでは、Formula と Inference クラスのテストの実行方法を説明します。

## 実装内容

### Formula クラス
Formula クラスは命題論理の記号文を表現します。

**主な機能:**
- 公式な記号文と非公式な記号文の両方をパース
- 記号文の妥当性チェック
- 原子文(文記号)の抽出
- 真偽値割り当てに基づく評価

**使用例:**
```python
from main import Formula

# 公式な記号文
f1 = Formula("(P∧Q)")
print(f1.is_formal)  # True

# 非公式な記号文
f2 = Formula("P∧Q")
print(f2.is_formal)  # False
print(f2.is_well_formed)  # True

# 評価
result = f2.evaluate({"P": True, "Q": False})
print(result)  # False
```

### Inference クラス
Inference クラスは推論を表現し、意味論的妥当性を判断します。

**主な機能:**
- 前提と結論から真偽値表を生成
- 意味論的妥当性の判断
- 反例の検出

**使用例:**
```python
from main import Formula, Inference

# Modus Ponens: P, P→Q ⊢ Q
p1 = Formula("P")
p2 = Formula("P→Q")
c = Formula("Q")
inf = Inference([p1, p2], c)

# 真偽値表の生成
inf.generate_truth_table()

# 妥当性の判断
print(inf.is_semantically_valid())  # True

# 真偽値表の表示
inf.print_truth_table()
```

## テストファイル

### 1. test_formula_inference.py
基本的な機能のテストを含みます。

**テスト内容:**
- 公式な記号文のパース
- 非公式な記号文のパース
- 無効な記号列の検出
- 記号文の評価
- 単純な推論 (Modus Ponens)
- 複雑な推論 (三段論法、選言三段論法、De Morgan の法則)
- 非公式な記号文を含む推論

**実行方法:**
```bash
python3 test_formula_inference.py
```

### 2. test_edge_cases.py
エッジケースのテストを含みます。

**テスト内容:**
- 下付き添字を含む原子文 (P_1, Q_2 など)
- 空白やタブを含む記号文
- 代替記号の使用 (&, |, ->, => など)
- 推論のエッジケース (トートロジー、矛盾など)
- 二重否定
- De Morgan の法則の完全なテスト
- 複雑にネストされた記号文

**実行方法:**
```bash
python3 test_edge_cases.py
```

### 3. demo.py
使用例のデモンストレーションを含みます。

**実行方法:**
```bash
python3 demo.py
```

## サポートされる記号

### 結合子
- 否定: `!`, `~`, `～`
- 連言: `&`, `∧`, `/\`
- 選言: `|`, `∨`, `\/`
- 含意: `->`, `→`, `=>`
- 同値: `<->`, `↔`, `<=>`

### 原子文
- 文記号: `P`, `Q`, `R`, ..., `Z`
- 下付き添字付き: `P_1`, `Q_2`, `R_3`, ...

### 括弧
- 丸括弧: `(`, `)`
- 角括弧: `[`, `]` (非公式な記号文でのみ)

## 公式な記号文と非公式な記号文

### 公式な記号文
README.md の定義に従った厳密な記号文:
- 原子文単独
- `~φ` の形式の否定
- `(φ∧ψ)`, `(φ∨ψ)`, `(φ→ψ)`, `(φ↔ψ)` の形式の二項演算

**例:**
```
P
~P
(P∧Q)
((P∧Q)→R)
```

### 非公式な記号文
以下の簡略化が許される:
1. 最外括弧の省略: `P∧Q`
2. 角括弧の使用: `[P∧Q]`
3. 演算子の優先順位: `∧`, `∨` > `→`, `↔`
   - 例: `P∧Q→R` は `((P∧Q)→R)` と同等
4. 左寄せの規則: 同じ演算子の連続は左結合
   - 例: `P∧Q∧R` は `((P∧Q)∧R)` と同等
   - 注意: `P∧Q∨R` は `∧` と `∨` の混在なのでエラー

**例:**
```
P∧Q
P∨Q→R
P∧Q∧R
[P→Q]
```

## テスト結果の確認

すべてのテストが成功すると、以下のようなメッセージが表示されます:

```
============================================================
全てのテストが成功しました！
============================================================
```

エラーがある場合は、詳細なエラーメッセージとともに失敗したテストが表示されます。

## 注意事項

- `∧` と `∨` を同じ優先順位で括弧なしに混在させることはできません
- 空白とタブは無視されます
- 原子文は `P` から `Z` までの大文字、または下付き添字付きのもの (`P_1` など)
- トークン化できない文字があるとエラーになります
